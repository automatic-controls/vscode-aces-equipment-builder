{
	"scopeName": "source.aceseb",
	"patterns": [
		{"include":"#blockDeveloperComments"},
		{"include":"#singleLineDeveloperComments"},
		{"include":"#blockComments"},
		{"include":"#singleLineComments"},
		{"include":"#cmdMultiLine"},
		{"include":"#cmdSingleLine"},
		{"name":"invalid.illegal.aceseb","match":".++"}
	],
	"repository": {
		"cmdSingleLine":{
			"patterns":[
				{
					"match":"\\s*+(Value)(\\(.*?\\))\\s*+$",
					"captures":{
						"1":{"patterns":[{"name":"keyword.control.aceseb","match":".++"}]},
						"2":{
							"patterns":[
								{
									"match":"\\(\\s*+([^,]++)\\s*+,\\s*+(-?+\\d++)\\s*+,\\s*+(-?+\\d++|(?i:-Inf))\\s*+,\\s*+(\\d++)\\s*+,\\s*+(-?+\\d++|(?i:Inf))\\s*+\\)",
									"captures":{
										"1":{"patterns":[{"include":"#filename"}]},
										"2":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"3":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"4":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"5":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]}
									}
								},
								{
									"match":"\\(\\s*+(-?+\\d++)\\s*+,\\s*+(-?+\\d++|(?i:-Inf))\\s*+,\\s*+(\\d++)\\s*+,\\s*+(-?+\\d++|(?i:Inf))\\s*+\\)",
									"captures":{
										"1":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"2":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"3":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"4":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]}
									}
								},
								{"name":"invalid.illegal.aceseb","match":".++"}
							]
						}
					}
				},
				{
					"match":"\\s*+(Condition)(\\(.*?\\))\\s*+$",
					"captures":{
						"1":{
							"patterns":[{"name":"keyword.control.aceseb","match":".++"}]
						},
						"2":{
							"patterns":[
								{
									"match":"\\(\\s*+([^,\"<>]++),\\s*+((?><[^<>]*+>|[^,\"])++),\\s*+(\"(?>\\\\.|[^\"])*+\")\\s*+\\)",
									"captures":{
										"1":{"patterns":[{"include":"#filename"}]},
										"2":{"patterns":[{"include":"#expression"}]},
										"3":{"patterns":[{"include":"#string"}]}
									}
								},
								{
									"match":"\\(\\s*+((?><[^<>]*+>|[^,\"])++),\\s*+(\"(?>\\\\.|[^\"])*+\")\\s*+\\)",
									"captures":{
										"1":{"patterns":[{"include":"#expression"}]},
										"2":{"patterns":[{"include":"#string"}]}
									}
								},
								{"name":"invalid.illegal.aceseb","match":".++"}
							]
						}
					}
				},
				{
					"match":"\\s*+([\\+\\-\\*@\\s]*+)([^\"]++)(?>(\".*\")\\s*+)?+$",
					"captures":{
						"1":{"patterns":[{"name":"storage.modifier","match":".++"}]},
						"2":{
							"patterns":[
								{
									"match":"([^/\\\\]*+(?>/|\\\\).++)",
									"captures":{
										"1":{"patterns":[{"include":"#referencePath"}]}
									}
								},
								{"include":"#filename"}
							]
						},
						"3":{"patterns":[{"include":"#string"}]}
					}
				}
			]
		},
		"cmdMultiLine":{
			"patterns":[
				{
					"begin":"\\s*+(Group)(\\([^\\(\\)]*+\\))\\[\\s*+$",
					"end":"\\]\\s*+$",
					"beginCaptures":{
						"1":{
							"patterns":[{"name":"keyword.control.aceseb","match":".++"}]
						},
						"2":{
							"patterns":[
								{
									"match":"\\(\\s*+(?>(\\d++)\\s*+,\\s*+)?(-1|\\d++|(?i:Inf))\\s*+\\)$",
									"captures":{
										"1":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"2":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]}
									}
								},
								{"name":"invalid.illegal.aceseb","match":".++"}
							]
						}
					},
					"patterns":[
						{
							"match":"(.+)(?=\\]\\s*+$)",
							"captures":{
								"1":{"patterns":[{"name":"invalid.illegal.aceseb","match":"."}]}
							}
						},
						{
							"match":"\\s*+(///)\\s*+(.*+)",
							"captures":{
								"1":{
									"patterns":[
										{
											"name":"comment.line.aceseb",
											"match":".++"
										}
									]
								},
								"2":{"patterns":[{"include":"#filename"}]}
							}
						},
						{"include":"#singleLineComments"},
						{
							"name":"invalid.illegal.aceseb",
							"match":"(?!\\]\\s*+$)\\s*+(.++)",
							"captures":{
								"1":{"patterns":[{"include":"#filename"}]}
							}
						}
					]
				},
				{
					"begin":"\\s*+(PreScript|PostScript)\\(([^\\(\\)]*+)\\)\\[\\s*+$",
					"end":"^\\s*+\\]\\s*+$",
					"beginCaptures":{
						"1":{"patterns":[{"name":"keyword.control.aceseb","match":".++"}]},
						"2":{"patterns":[{"include":"#filename"}]}
					},
					"patterns":[
						{
							"name":"constant.character.escape.aceseb",
							"match":"\\[(<.*?>)\\]",
							"captures":{
								"1":{
									"patterns":[
										{"include":"#getProperties"},
										{"name":"invalid.illegal.aceseb","match":".++"}
									]
								}
							}
						}
					]
				},
				{
					"begin":"\\s*+((?i:IF)) ?+\\[\\s*+$",
					"end":"(?>\\]( ?+)((?i:THEN))\\k<1>\\[|(\\]))(?=\\s*+$)",
					"beginCaptures":{
						"1":{"patterns":[{"name":"keyword.control.aceseb","match":".++"}]}
					},
					"endCaptures":{
						"2":{"patterns":[{"name":"keyword.control.aceseb","match":".++"}]},
						"3":{"patterns":[{"name":"invalid.illegal.aceseb","match":".++"}]}
					},
					"patterns":[
						{
							"match":"(.+)(?=\\](?>( ?+)(?i:THEN)\\k<2>\\[)?+\\s*+$)",
							"captures":{
								"1":{"patterns":[{"name":"invalid.illegal.aceseb","match":".++"}]}
							}
						},
						{
							"match":"\\s*+(///)\\s*+(.*+)",
							"captures":{
								"1":{
									"patterns":[
										{
											"name":"comment.line.aceseb",
											"match":".++"
										}
									]
								},
								"2":{"patterns":[{"include":"#ifStatement"}]}
							}
						},
						{"include":"#singleLineComments"},
						{
							"match":"(?!\\](?>( ?+)(?i:THEN)\\k<1>\\[)?+\\s*+$)\\s*+(.++)",
							"captures":{
								"2":{"patterns":[{"include":"#ifStatement"}]}
							}
						}
					]
				},
				{
					"begin":"(?<=\\] ?+(?i:Then) ?+\\[)\\s*+$",
					"end":"\\]\\s*+$",
					"patterns":[
						{
							"match":"(.+)(?=\\]\\s*+$)",
							"captures":{
								"1":{"patterns":[{"name":"invalid.illegal.aceseb","match":"."}]}
							}
						},
						{
							"match":"\\s*+(///)\\s*+(.*+)",
							"captures":{
								"1":{
									"patterns":[
										{
											"name":"comment.line.aceseb",
											"match":".++"
										}
									]
								},
								"2":{"patterns":[{"include":"#thenStatement"}]}
							}
						},
						{"include":"#singleLineComments"},
						{
							"match":"(?!\\]\\s*+$)\\s*+(.++)",
							"captures":{
								"1":{"patterns":[{"include":"#thenStatement"}]}
							}
						}
					]
				}
			]
		},
		"ifStatement":{
			"patterns":[
				{
					"match":"([^\\&\\|<>=]*+(?>\\&|\\||<|>|=).*+)",
					"captures":{
						"1":{"patterns":[{"include":"#expression"}]}
					}
				},
				{"include":"#ifThenItem"},
				{"name":"invalid.illegal.aceseb","match":".++"}
			]
		},
		"thenStatement":{
			"patterns":[
				{
					"match":"([^\\&\\|<>=]*+(?>\\&|\\||<|>|=).*+)",
					"captures":{
						"1":{"patterns":[{"include":"#setProperties"}]}
					}
				},
				{"include":"#ifThenItem"},
				{"name":"invalid.illegal.aceseb","match":".++"}
			]
		},
		"ifThenItem":{
			"patterns":[
				{
					"match":"((?>\\!\\+|!-|!\\*|!@|\\+|-|\\*|@|\\s)++|!)?+\\s*+(.++)",
					"captures":{
						"1":{"patterns":[{"name":"storage.modifier","match":".++"}]},
						"2":{"patterns":[{"include":"#referencePathNoGroup"}]}
					}
				}
			]
		},
		"expression":{
			"patterns":[
				{
					"name":"keyword.operator.aceseb",
					"match":"\\s*+(?>(!\\s*+)?+(\\((?>[^\\(\\)]|\\g<2>)++\\))\\s*+|((?><[^<>!\\&\\|]*+\\|[^<>!\\(\\)\\&\\|]*+>|[^\\(\\)\\&\\|])++))(.*+)",
					"captures":{
						"1":{"patterns":[{"name":"storage.modifier","match":".++"}]},
						"2":{
							"patterns":[
								{
									"match":"\\((.*?)\\)$",
									"captures":{
										"1":{"patterns":[{"include":"#expression"}]}
									}
								}
							]
						},
						"3":{"patterns":[{"include":"#subexpression"}]},
						"4":{
							"patterns":[
								{
									"match":"(?>&&|\\|\\|)\\s*+(.++)",
									"captures":{
										"1":{"patterns":[{"include":"#expression"}]}
									}
								},
								{"name":"invalid.illegal.aceseb","match":".++"}
							]
						}
					}
				},
				{"name":"invalid.illegal.aceseb","match":".++"}
			],
			"repository":{
				"subexpression":{
					"patterns":[
						{
							"match":"(?>(-?+\\d++)|(<[^<>]*+>))\\s*+(?>(?><=|>=|==|!=|<|>)\\s*+(?>(-?+\\d++)|(<[^<>]*+>))\\s*+)?+$",
							"captures":{
								"1":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
								"2":{"patterns":[{"include":"#subexprprop"}]},
								"3":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
								"4":{"patterns":[{"include":"#subexprprop"}]}
							}
						},
						{
							"name":"invalid.illegal.aceseb",
							"match":".++"
						}
					]
				},
				"subexprprop":{
					"patterns":[
						{"include":"#getProperties"},
						{
							"name":"invalid.illegal.aceseb",
							"match":".++"
						}
					]
				}
			}
		},
		"string":{
			"patterns":[
				{
					"name":"string.quoted.double.aceseb",
					"match":".++",
					"captures":{
						"0":{
							"patterns":[
								{"include":"#escape"},
								{"include":"#unicode"},
								{"include":"#getProperties"},
								{
									"name":"invalid.illegal.aceseb",
									"match":"<|>"
								},
								{"include":"#ternary"},
								{
									"name":"invalid.illegal.aceseb",
									"match":"\\[|\\]|\\?|:"
								}
							]
						}
					}
				}
			]
		},
		"ternary":{
			"patterns":[
				{
					"name":"constant.character.escape.aceseb",
					"match":"\\[((?>\\\\.|[^\\[\\]\\?:]|(?<a>\\[(?>\\\\.|[^\\[\\]]|\\g<a>)*+\\]))++)\\?((?>\\\\.|[^\\[\\]\\?:]|(?<b>\\[(?>\\\\.|[^\\[\\]]|\\g<b>)*+\\]))*+):((?>\\\\.|[^\\[\\]\\?:]|(?<c>\\[(?>\\\\.|[^\\[\\]]|\\g<c>)*+\\]))*+)\\]",
					"captures":{
						"1":{"patterns":[{"include":"#expression"}]},
						"3":{"patterns":[{"include":"#string"}]},
						"5":{"patterns":[{"include":"#string"}]}
					}
				}
			]
		},
		"referencePath":{
			"patterns":[
				{
					"name":"variable.parameter.aceseb",
					"match":"\\s*+(/|\\\\)?+(.*?)(/|\\\\)?+\\s*+$",
					"captures":{
						"1":{"patterns":[{"name":"keyword.operator.aceseb","match":".++"}]},
						"2":{
							"patterns":[
								{
									"name":"invalid.illegal.aceseb",
									"match":"(?<=/|\\\\)\\s*+(?>/|\\\\)"
								},
								{
									"name":"keyword.other.aceseb",
									"match":"\\s*+Group\\(\\s*+(\\d++)\\s*+,\\s*+(\\d++)\\s*+\\)\\s*+($|/|\\\\)",
									"captures":{
										"1":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"2":{"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]},
										"3":{"patterns":[{"name":"keyword.operator.aceseb","match":".++"}]}
									}
								},
								{
									"match":"\\s*+(~)\\s*+($|/|\\\\)",
									"captures":{
										"1":{"patterns":[{"name":"keyword.other.aceseb","match":".++"}]},
										"2":{"patterns":[{"name":"keyword.operator.aceseb","match":".++"}]}
									}
								},
								{
									"match":"([^/\\\\]++)($|/|\\\\)",
									"captures":{
										"1":{"patterns":[{"include":"#filename"}]},
										"2":{"patterns":[{"name":"keyword.operator.aceseb","match":".++"}]}
									}
								}
							]
						},
						"3":{"patterns":[{"name":"invalid.illegal.aceseb","match":".++"}]}
					}
				}
			]
		},
		"referencePathNoGroup":{
			"patterns":[
				{
					"name":"variable.parameter.aceseb",
					"match":"\\s*+(/|\\\\)?+(.*?)(/|\\\\)?+\\s*+$",
					"captures":{
						"1":{"patterns":[{"name":"keyword.operator.aceseb","match":".++"}]},
						"2":{
							"patterns":[
								{
									"name":"invalid.illegal.aceseb",
									"match":"(?<=/|\\\\)\\s*+(?>/|\\\\)"
								},
								{
									"match":"\\s*+(~)\\s*+($|/|\\\\)",
									"captures":{
										"1":{"patterns":[{"name":"keyword.other.aceseb","match":".++"}]},
										"2":{"patterns":[{"name":"keyword.operator.aceseb","match":".++"}]}
									}
								},
								{
									"match":"([^/\\\\]++)($|/|\\\\)",
									"captures":{
										"1":{"patterns":[{"include":"#filename"}]},
										"2":{"patterns":[{"name":"keyword.operator.aceseb","match":".++"}]}
									}
								}
							]
						},
						"3":{"patterns":[{"name":"invalid.illegal.aceseb","match":".++"}]}
					}
				}
			]
		},
		"setProperties":{
			"patterns":[
				{
					"name":"constant.character.escape.aceseb",
					"match":"\\s*+<([^<>\\|]*+)\\|\\s*+([a-zA-Z]++)\\s*+>\\s*+=\\s*+(.++)",
					"captures":{
						"1":{"patterns":[{"include":"#referencePath"}]},
						"2":{
							"patterns":[
								{
									"name":"constant.language.aceseb",
									"match":"\\s*+(?i:VALUE|MIN|MAX|MINIMUM|MAXIMUM|INCREMENT)\\s*+$"
								},
								{"name":"invalid.illegal.aceseb","match":".++"}
							]
						},
						"3":{
							"patterns":[
								{
									"name":"constant.numeric.aceseb",
									"match":"\\d++\\s*+$"
								},
								{
									"match":"(<[^<>]++>)$",
									"captures":{
										"1":{
											"patterns":[
												{"include":"#getProperties"},
												{"name":"invalid.illegal.aceseb","match":".++"}
											]
										}
									}
								},
								{"name":"invalid.illegal.aceseb","match":".++"}
							]
						}
					}
				},
				{"name":"invalid.illegal.aceseb","match":".++"}
			]
		},
		"getProperties":{
			"patterns":[
				{
					"name":"constant.character.escape.aceseb",
					"match":"<\\s*+([^<>\\|]*+)\\|\\s*+([a-zA-Z@]++)\\s*+>",
					"captures":{
						"1":{"patterns":[{"include":"#referencePath"}]},
						"2":{"patterns":[{"include":"#getPropertyNames"}]}
					}
				}
			]
		},
		"getPropertyNames":{
			"patterns":[
				{
					"name":"constant.language.aceseb",
					"match":"\\s*+(?i:@SELECTED|@VISIBLE|SELECTED|VISIBLE|LOCKED|VALUECHANGING|EXISTS|VALUE|MIN|MAX|MINIMUM|MAXIMUM|INCREMENT|DISPLAYNAME|REFERENCENAME|EQUIPMENTNAME|FILEPATH)\\s*+$"
				},
				{"name":"invalid.illegal.aceseb","match":".++"}
			]
		},
		"unicode":{
			"patterns":[
				{
					"name":"constant.character.escape.aceseb",
					"match":"\\{(\\d+)\\}",
					"captures":{
						"1":{
							"patterns":[{"name":"constant.numeric.aceseb","match":".++"}]
						}
					}
				},
				{
					"name":"invalid.illegal.aceseb",
					"match":"\\{|\\}"
				}
			]
		},
		"escape":{
			"patterns":[
				{
					"name":"constant.character.escape.aceseb",
					"match":"\\\\."
				}
			]
		},
		"filename":{
			"patterns":[
				{
					"name":"variable.parameter.aceseb",
					"match":"[a-zA-Z0-9_ ]++$"
				},
				{
					"name":"invalid.illegal.aceseb",
					"match":".++"
				}
			]
		},
		"singleLineComments":{
			"patterns":[
				{
					"name":"comment.line.aceseb",
					"match":"\\s*+//.*+$"
				}
			]
		},
		"blockComments":{
			"patterns":[
				{
					"name":"comment.block.aceseb",
					"begin":"^\\s*+/\\*",
					"end":"\\*/\\s*+$"
				}
			]
		},
		"singleLineDeveloperComments":{
			"patterns":[
				{
					"match":"^\\s*+(///)(.*?)\\s*+$",
					"captures":{
						"1":{
							"patterns":[
								{
									"name":"comment.line.aceseb",
									"match":".++"
								}
							]
						},
						"2":{
							"patterns":[
								{ "include":"#cmdSingleLine" },
								{"name":"invalid.illegal.aceseb","match":".++"}
							]
						}
					}
				}
			]
		},
		"blockDeveloperComments":{
			"patterns":[
				{
					"begin":"^\\s*+(/\\*\\*)",
					"end":"(\\*/)\\s*+$",
					"captures":{
						"1":{"patterns":[{"name":"comment.block.aceseb","match":"."}]}
					},
					"patterns":[
						{
							"match":"(.+)(?=\\*/\\s*+$)",
							"captures":{
								"1":{"patterns":[{"name":"invalid.illegal.aceseb","match":"."}]}
							}
						},
						{"include":"#singleLineDeveloperComments"},
						{"include":"#singleLineComments"},
						{"include":"#cmdMultiLine"},
						{"include":"#cmdSingleLine"},
						{"name":"invalid.illegal.aceseb","match":"(?!\\*/\\s*+$).++"}
					]
				}
			]
		}
	}
}